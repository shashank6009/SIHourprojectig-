module.exports=[120267,e=>e.a(async(t,r)=>{try{let t=await e.y("@react-pdf/renderer");e.n(t),r()}catch(e){r(e)}},!0),334654,e=>{"use strict";function t(e){let t=[];e.contact?.email&&t.push(e.contact.email),e.contact?.phone&&t.push(e.contact.phone),e.contact?.links&&t.push(...e.contact.links);let r={name:e.fullName||"Your Name",role:e.targetRole||"Professional",contactLines:t},a=[],o=new Set,i={education:"EDUCATION",project:"PROJECTS",experience:"EXPERIENCE",volunteer:"VOLUNTEER WORK",skill:"SKILLS"},n=e.blocks.reduce((e,t)=>(e[t.type]||(e[t.type]=[]),e[t.type].push(t),e),{});return["education","project","experience","volunteer","skill"].forEach(t=>{let r=n[t]||[];if(0===r.length)return;let s=[];if(r.forEach(t=>{(e.tailoredContent?.rewrittenBlocks?.find(e=>e.id===t.id)?.bullets||t.details).forEach(e=>{let t=function(e){if(!e)return"";let t=e.replace(/\b[A-Za-z0-9._%+-]+@[A-Za-z0-9.-]+\.[A-Z|a-z]{2,}\b/g,"[email]").replace(/\b\d{3}[-.]?\d{3}[-.]?\d{4}\b/g,"[phone]").replace(/\b\(\d{3}\)\s*\d{3}[-.]?\d{4}\b/g,"[phone]");if((t=t.replace(/[•▪▫‣⁃]/g,"•").replace(/[–—]/g,"-").replace(/[""]/g,'"').replace(/['']/g,"'")).length>95){let e=t.split(" "),r=[],a="";e.forEach(e=>{(a+" "+e).length>90?(a&&r.push(a),a=e):a=a?a+" "+e:e}),a&&r.push(a),t=r.join("\n")}return t.trim()}(e);t&&!o.has(t)&&(o.add(t),s.push(t))})}),s.length>0){let e=s.slice(0,6);s.length>6&&e.push("+ more available on request"),a.push({title:i[t],bullets:e})}}),{header:r,sections:a}}e.s(["normalizeForPdf",()=>t])},222260,(e,t,r)=>{"use strict";t.exports=e.r(442315).vendored["react-rsc"].ReactJsxRuntime},438963,e=>e.a(async(t,r)=>{try{e.s(["baseStyles",()=>l,"renderContact",()=>n,"renderSection",()=>s]);var a=e.i(222260),o=e.i(120267),i=t([o]);[o]=i.then?(await i)():i,o.Font.register({family:"Helvetica",src:"https://fonts.gstatic.com/s/helvetica/v1/helvetica.ttf"}),o.Font.register({family:"Helvetica-Bold",src:"https://fonts.gstatic.com/s/helvetica/v1/helvetica-bold.ttf"});let l=o.StyleSheet.create({page:{flexDirection:"column",backgroundColor:"#FFFFFF",padding:72,fontFamily:"Helvetica",fontSize:11,lineHeight:1.25,color:"#000000"},header:{marginBottom:20,textAlign:"center"},name:{fontSize:18,fontFamily:"Helvetica-Bold",marginBottom:4,color:"#000000"},role:{fontSize:12,fontFamily:"Helvetica",marginBottom:8,color:"#333333"},contact:{fontSize:10,fontFamily:"Helvetica",color:"#666666",flexDirection:"row",justifyContent:"center",flexWrap:"wrap"},contactItem:{marginHorizontal:8},section:{marginBottom:16},sectionTitle:{fontSize:10,fontFamily:"Helvetica-Bold",marginBottom:6,color:"#000000",textTransform:"uppercase",letterSpacing:.5},bulletList:{marginLeft:0},bulletItem:{fontSize:10,fontFamily:"Helvetica",marginBottom:3,lineHeight:1.2,color:"#000000"},bullet:{marginRight:4},period:{fontSize:9,fontFamily:"Helvetica",color:"#666666",fontStyle:"italic",marginBottom:2},subtitle:{fontSize:10,fontFamily:"Helvetica-Bold",color:"#333333",marginBottom:3}});function n(e){return 0===e.length?null:(0,a.jsx)("div",{style:l.contact,children:e.map((e,t)=>(0,a.jsx)("span",{style:l.contactItem,children:e},t))})}function s(e,t,r,o){return(0,a.jsxs)("div",{style:l.section,children:[(0,a.jsx)("div",{style:l.sectionTitle,children:e}),r&&(0,a.jsx)("div",{style:l.period,children:r}),o&&(0,a.jsx)("div",{style:l.subtitle,children:o}),(0,a.jsx)("div",{style:l.bulletList,children:t.map((e,t)=>(0,a.jsxs)("div",{style:l.bulletItem,children:[(0,a.jsx)("span",{style:l.bullet,children:"•"}),e.split("\n").map((e,t)=>(0,a.jsxs)("span",{children:[t>0&&"\n",e]},t))]},t))})]})}r()}catch(e){r(e)}},!1),435021,e=>e.a(async(t,r)=>{try{e.s(["TemplateClassic",()=>s]);var a=e.i(222260),o=e.i(120267),i=e.i(438963),n=t([o,i]);function s({model:e,options:t}){let r=t.fontSize||11,n=t.lineHeight||1.25,s=!1!==t.includeContact;return(0,a.jsx)(o.Document,{children:(0,a.jsxs)(o.Page,{size:"A4",style:[i.baseStyles.page,{fontSize:r,lineHeight:n}],children:[(0,a.jsxs)(o.View,{style:i.baseStyles.header,children:[(0,a.jsx)(o.Text,{style:i.baseStyles.name,children:e.header.name}),(0,a.jsx)(o.Text,{style:i.baseStyles.role,children:e.header.role}),s&&(0,i.renderContact)(e.header.contactLines)]}),e.sections.map((e,t)=>(0,a.jsx)(o.View,{children:(0,i.renderSection)(e.title,e.bullets,e.period,e.subtitle)},t))]})})}[o,i]=n.then?(await n)():n,r()}catch(e){r(e)}},!1),798074,e=>e.a(async(t,r)=>{try{e.s(["TemplateCompact",()=>s]);var a=e.i(222260),o=e.i(120267),i=e.i(438963),n=t([o,i]);[o,i]=n.then?(await n)():n;let l=o.StyleSheet.create({page:{...i.baseStyles.page,padding:60},header:{...i.baseStyles.header,marginBottom:16},name:{...i.baseStyles.name,fontSize:16},role:{...i.baseStyles.role,fontSize:11},contact:{...i.baseStyles.contact,fontSize:9},section:{...i.baseStyles.section,marginBottom:12},sectionTitle:{...i.baseStyles.sectionTitle,fontSize:9,marginBottom:4},bulletItem:{...i.baseStyles.bulletItem,fontSize:9,marginBottom:2},period:{...i.baseStyles.period,fontSize:8},subtitle:{...i.baseStyles.subtitle,fontSize:9}});function s({model:e,options:t}){let r=t.fontSize||10.5,n=t.lineHeight||1.2,s=!1!==t.includeContact;return(0,a.jsx)(o.Document,{children:(0,a.jsxs)(o.Page,{size:"A4",style:[l.page,{fontSize:r,lineHeight:n}],children:[(0,a.jsxs)(o.View,{style:l.header,children:[(0,a.jsx)(o.Text,{style:l.name,children:e.header.name}),(0,a.jsx)(o.Text,{style:l.role,children:e.header.role}),s&&(0,a.jsx)(o.View,{style:l.contact,children:e.header.contactLines.map((e,t)=>(0,a.jsx)(o.Text,{style:{marginHorizontal:6},children:e},t))})]}),e.sections.map((e,t)=>(0,a.jsx)(o.View,{children:(0,a.jsxs)(o.View,{style:l.section,children:[(0,a.jsx)(o.Text,{style:l.sectionTitle,children:e.title}),e.period&&(0,a.jsx)(o.Text,{style:l.period,children:e.period}),e.subtitle&&(0,a.jsx)(o.Text,{style:l.subtitle,children:e.subtitle}),(0,a.jsx)(o.View,{style:i.baseStyles.bulletList,children:e.bullets.map((e,t)=>(0,a.jsxs)(o.Text,{style:l.bulletItem,children:["• ",e]},t))})]})},t))]})})}r()}catch(e){r(e)}},!1),881509,e=>e.a(async(t,r)=>{try{e.s(["TemplateModern",()=>s]);var a=e.i(222260),o=e.i(120267),i=e.i(438963),n=t([o,i]);[o,i]=n.then?(await n)():n;let l=o.StyleSheet.create({page:{...i.baseStyles.page,padding:72},header:{...i.baseStyles.header,marginBottom:24,borderBottomWidth:1,borderBottomColor:"#E5E5E5",paddingBottom:16},name:{...i.baseStyles.name,fontSize:20,marginBottom:6},role:{...i.baseStyles.role,fontSize:13,marginBottom:10},contact:{...i.baseStyles.contact,fontSize:10},section:{...i.baseStyles.section,marginBottom:18},sectionTitle:{...i.baseStyles.sectionTitle,fontSize:11,marginBottom:8,borderBottomWidth:.5,borderBottomColor:"#CCCCCC",paddingBottom:2},bulletItem:{...i.baseStyles.bulletItem,fontSize:10,marginBottom:4},period:{...i.baseStyles.period,fontSize:9},subtitle:{...i.baseStyles.subtitle,fontSize:10}});function s({model:e,options:t}){let r=t.fontSize||12,n=t.lineHeight||1.3,s=!1!==t.includeContact;return(0,a.jsx)(o.Document,{children:(0,a.jsxs)(o.Page,{size:"A4",style:[l.page,{fontSize:r,lineHeight:n}],children:[(0,a.jsxs)(o.View,{style:l.header,children:[(0,a.jsx)(o.Text,{style:l.name,children:e.header.name}),(0,a.jsx)(o.Text,{style:l.role,children:e.header.role}),s&&(0,a.jsx)(o.View,{style:l.contact,children:e.header.contactLines.map((e,t)=>(0,a.jsx)(o.Text,{style:{marginHorizontal:10},children:e},t))})]}),e.sections.map((e,t)=>(0,a.jsx)(o.View,{children:(0,a.jsxs)(o.View,{style:l.section,children:[(0,a.jsx)(o.Text,{style:l.sectionTitle,children:e.title}),e.period&&(0,a.jsx)(o.Text,{style:l.period,children:e.period}),e.subtitle&&(0,a.jsx)(o.Text,{style:l.subtitle,children:e.subtitle}),(0,a.jsx)(o.View,{style:i.baseStyles.bulletList,children:e.bullets.map((e,t)=>(0,a.jsxs)(o.Text,{style:l.bulletItem,children:["• ",e]},t))})]})},t))]})})}r()}catch(e){r(e)}},!1),592738,e=>e.a(async(t,r)=>{try{e.s(["renderPdfBuffer",()=>d]);var a=e.i(347540),o=e.i(120267),i=e.i(334654),n=e.i(435021),s=e.i(798074),l=e.i(881509),c=t([o,n,s,l]);async function d(e){let t,r=(0,i.normalizeForPdf)({...e.content,fullName:e.meta?.fullName,contact:e.meta?.contact,targetRole:e.meta?.targetRole});switch(e.options.template){case"compact":t=s.TemplateCompact;break;case"modern":t=l.TemplateModern;break;default:t=n.TemplateClassic}let c=(0,o.pdf)(a.default.createElement(t,{model:r,options:e.options}));return await c.toBuffer()}[o,n,s,l]=c.then?(await c)():c,r()}catch(e){r(e)}},!1),149807,e=>{"use strict";async function t(e,t,r,a){return`
Dear ${r?`${r} Hiring Team`:"Hiring Manager"},

I am writing to express my strong interest in the ${a||"position"} at ${r||"your organization"}. Based on the job description, I believe my background aligns well with your requirements.

${e.slice(0,2).map((e,t)=>{let r=e.details?.[0]||e.description||"Relevant experience";return`In my experience, I have ${r.toLowerCase()}. This demonstrates my ability to deliver results in areas relevant to your needs.`}).join("\n\n")}

I am excited about the opportunity to contribute to ${r||"your team"} and would welcome the chance to discuss how my skills and experience can add value to your organization.

Thank you for your consideration. I look forward to hearing from you.

Best regards,
[Your Name]
`.trim()}function r(e,t,r){let a=(r||["Delivered measurable results in previous roles","Strong technical and analytical skills","Proven track record of collaboration and leadership"]).slice(0,3).map(e=>`• ${e}`).join("\n");return`Subject: ${t?`${t} — `:""}Application | Impact-focused candidate

Hi ${e?`Recruiting Team at ${e}`:"Recruiting Team"},

I tailored my resume specifically for the ${t||"role"}. Highlights:
${a}

Would appreciate a 15-min conversation this week to discuss fit.

Best,
<Name> | <Email> | <Phone> | <LinkedIn>`}function a(e,t,r){return`Hi ${e?`${e} team`:"there"}, 

I aligned my resume to ${t||"the role"} and quantified outcomes (e.g., ${r||"improved efficiency by 25%"}). Open to a quick chat? 

<short link to portfolio/resume>`}e.s(["generateCoverLetter",()=>t,"generateEmailTemplate",()=>r,"generateInMailTemplate",()=>a])},595560,e=>e.a(async(t,r)=>{try{e.s(["TemplateCoverLetter",()=>n]);var a=e.i(222260),o=e.i(120267),i=t([o]);[o]=i.then?(await i)():i,o.Font.register({family:"Helvetica",src:"https://fonts.gstatic.com/s/helvetica/v1/helvetica.ttf"}),o.Font.register({family:"Helvetica-Bold",src:"https://fonts.gstatic.com/s/helvetica/v1/helvetica-bold.ttf"});let s=o.StyleSheet.create({page:{flexDirection:"column",backgroundColor:"#FFFFFF",padding:72,fontFamily:"Helvetica",fontSize:11,lineHeight:1.4,color:"#000000"},header:{marginBottom:20},date:{fontSize:10,fontFamily:"Helvetica",color:"#666666",marginBottom:20,textAlign:"right"},recipient:{fontSize:11,fontFamily:"Helvetica",color:"#000000",marginBottom:20},greeting:{fontSize:11,fontFamily:"Helvetica",color:"#000000",marginBottom:15},paragraph:{fontSize:11,fontFamily:"Helvetica",color:"#000000",marginBottom:15,lineHeight:1.4,textAlign:"justify"},closing:{fontSize:11,fontFamily:"Helvetica",color:"#000000",marginTop:20,marginBottom:5},signature:{fontSize:11,fontFamily:"Helvetica",color:"#000000",marginBottom:5},contact:{fontSize:10,fontFamily:"Helvetica",color:"#666666"}});function n({text:e,meta:t}){let r=e.split("\n\n").map(e=>e.trim()).filter(e=>e.length>0),i=r.find(e=>e.toLowerCase().includes("dear")||e.toLowerCase().includes("hi ")||e.toLowerCase().includes("hello")),n=r.find(e=>e.toLowerCase().includes("sincerely")||e.toLowerCase().includes("best regards")||e.toLowerCase().includes("thank you")),l=r.filter(e=>e!==i&&e!==n),c=new Date().toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"});return(0,a.jsx)(o.Document,{children:(0,a.jsxs)(o.Page,{size:"A4",style:s.page,children:[(0,a.jsx)(o.Text,{style:s.date,children:c}),(0,a.jsxs)(o.Text,{style:s.recipient,children:["Hiring Manager","\n","[Company Name]","\n","[Company Address]"]}),i&&(0,a.jsx)(o.Text,{style:s.greeting,children:i}),l.map((e,t)=>(0,a.jsx)(o.Text,{style:s.paragraph,children:e},t)),n&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(o.Text,{style:s.closing,children:n}),(0,a.jsx)(o.Text,{style:s.signature,children:t?.name||"[Your Name]"}),t?.contact&&(0,a.jsxs)(o.Text,{style:s.contact,children:[t.contact.email&&`${t.contact.email} | `,t.contact.phone&&`${t.contact.phone} | `,t.contact.linkedin&&t.contact.linkedin]})]})]})})}r()}catch(e){r(e)}},!1),856949,e=>e.a(async(t,r)=>{try{e.s(["runBatch",()=>h]);var a=e.i(347540),o=e.i(876177),i=e.i(592738),n=e.i(84690),s=e.i(149807),l=e.i(595560),c=e.i(120267),d=e.i(362693),u=e.i(50381),m=t([i,l,c]);async function p(e){try{console.log(`Processing batch item: ${e}`);let{data:t,error:r}=await d.supabaseServer.from("resume_batch_items").select(`
        *,
        resume_batches!inner(user_id)
      `).eq("id",e).single();if(r||!t)throw Error(`Failed to load batch item: ${r?.message}`);let m=t.resume_batches.user_id,{data:p,error:h}=await d.supabaseServer.from("resume_versions").select("*").eq("resume_id",await f(m)).order("created_at",{ascending:!1}).limit(1);if(h||!p||0===p.length)throw Error(`No resume versions found for user: ${h?.message}`);let g=p[0],y=g.content?.blocks||[];if(0===y.length)throw Error("No resume blocks found in the latest version");let b=await (0,n.normalizeJD)({url:t.jd_url,text:t.jd_text});await d.supabaseServer.from("resume_batch_items").update({company:b.company||t.company,role:b.role||t.role,jd_text:b.jdText,keywords:b.keywords,status:"processing",updated_at:new Date().toISOString()}).eq("id",e);let x=await (0,o.coachAndTailor)({blocks:y,jd:{text:b.jdText,keywords:b.keywords}}),S={resume_id:g.resume_id,label:`Tailored for ${b.company||b.role||"Position"}`,content:{blocks:x.rewrittenBlocks.map(e=>({id:e.id,type:"experience",title:"Tailored Experience",details:e.bullets})),rationale:`Tailored for ${b.company||b.role||"position"} based on job requirements`,tailoredContent:{rewrittenBlocks:x.rewrittenBlocks,atsScore:x.atsScore,gapSuggestions:x.gapSuggestions,jdKeywords:b.keywords,jdText:b.jdText}},ats_score:x.atsScore,created_at:new Date().toISOString()},{data:w,error:v}=await d.supabaseServer.from("resume_versions").insert(S).select().single();if(v||!w)throw Error(`Failed to create tailored version: ${v?.message}`);let T=await (0,s.generateCoverLetter)(y,b.jdText,b.company,b.role);await (0,u.trackModelRun)({userId:m,resumeVersionId:w.id,provider:"openai",model:"gpt-4o-mini",promptKey:`SYSTEM_COVER@${new Date().toISOString().split("T")[0]}`,atsScore:x.atsScore});let j=await (0,i.renderPdfBuffer)({content:w.content,options:{template:"classic"},meta:{fullName:"Your Name",targetRole:b.role}}),E=(0,c.pdf)(a.default.createElement(l.TemplateCoverLetter,{text:T,meta:{name:"Your Name",contact:{email:"your.email@example.com",phone:"+1 (555) 123-4567"}}})),R=await E.toBuffer(),C=`resumes/${m}/${e}/resume.pdf`,_=`resumes/${m}/${e}/cover.pdf`,{error:B}=await d.supabaseServer.storage.from("resumes").upload(C,j,{contentType:"application/pdf",upsert:!0});if(B)throw Error(`Failed to upload resume PDF: ${B.message}`);let{error:k}=await d.supabaseServer.storage.from("resumes").upload(_,R,{contentType:"application/pdf",upsert:!0});if(k)throw Error(`Failed to upload cover letter PDF: ${k.message}`);let{data:$}=d.supabaseServer.storage.from("resumes").getPublicUrl(C),{data:H}=d.supabaseServer.storage.from("resumes").getPublicUrl(_),I=(0,s.generateEmailTemplate)(b.company,b.role,x.rewrittenBlocks.slice(0,3).map(e=>e.bullets[0])),z=(0,s.generateInMailTemplate)(b.company,b.role,x.rewrittenBlocks[0]?.bullets[0]),F={resumePdf:$.publicUrl,coverPdf:H.publicUrl,emailTxt:I,inmailTxt:z},{error:N}=await d.supabaseServer.from("resume_batch_items").update({status:"done",ats_score:x.atsScore,resume_version_id:w.id,assets:F,updated_at:new Date().toISOString()}).eq("id",e);if(N)throw Error(`Failed to update batch item: ${N.message}`);await (0,u.trackEvent)({userId:m,event:"BATCH_ITEM_COMPLETED",resumeVersionId:w.id,metadata:{atsScore:x.atsScore,company:b.company,role:b.role,batchId:t.batch_id}});let P=process.env.N8N_WEBHOOK_URL;if(P)try{await fetch(P,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({itemId:e,company:b.company,role:b.role,atsScore:x.atsScore,assets:F,status:"completed"})})}catch(e){console.warn("Failed to send webhook notification:",e)}console.log(`Successfully processed batch item: ${e}`)}catch(t){throw console.error(`Error processing batch item ${e}:`,t),await d.supabaseServer.from("resume_batch_items").update({status:"failed",error:t instanceof Error?t.message:"Unknown error",updated_at:new Date().toISOString()}).eq("id",e),t}}async function h(e,t={}){let{concurrency:r=2,maxRetries:a=3,retryDelay:o=1e3}=t;try{await d.supabaseServer.from("resume_batches").update({status:"running",updated_at:new Date().toISOString()}).eq("id",e);let{data:t,error:i}=await d.supabaseServer.from("resume_batch_items").select("id").eq("batch_id",e).eq("status","queued").order("created_at",{ascending:!0});if(i||!t)throw Error(`Failed to load batch items: ${i?.message}`);console.log(`Processing ${t.length} items in batch ${e} with concurrency ${r}`);let n=await g(t.map(e=>e.id),p,r,a,o),s=n.filter(e=>e.success).length,l=n.filter(e=>!e.success).length;await d.supabaseServer.from("resume_batches").update({status:0===l||s>0?"completed":"failed",processed:s,failed:l,updated_at:new Date().toISOString()}).eq("id",e),console.log(`Batch ${e} completed: ${s} processed, ${l} failed`)}catch(t){throw console.error(`Error running batch ${e}:`,t),await d.supabaseServer.from("resume_batches").update({status:"failed",updated_at:new Date().toISOString()}).eq("id",e),t}}async function f(e){let{data:t,error:r}=await d.supabaseServer.from("resumes").select("id").eq("user_id",e).order("created_at",{ascending:!1}).limit(1);if(r||!t||0===t.length)throw Error(`No resumes found for user: ${r?.message}`);return t[0].id}async function g(e,t,r,a,o){let i=[],n=[...e],s=async e=>{let r;for(let i=1;i<=a;i++)try{await t(e);return}catch(t){r=t instanceof Error?t:Error("Unknown error"),i<a&&(console.log(`Retry ${i}/${a} for item:`,e),await new Promise(e=>setTimeout(e,o*i)))}throw r},l=[];for(let e=0;e<r;e++)l.push((async()=>{for(;n.length>0;){let e=n.shift();if(!e)break;try{await s(e),i.push({success:!0,item:e})}catch(t){i.push({success:!1,item:e,error:t instanceof Error?t:Error("Unknown error")})}}})());return await Promise.all(l),i}[i,l,c]=m.then?(await m)():m,r()}catch(e){r(e)}},!1),225124,e=>e.a(async(t,r)=>{try{e.s(["POST",()=>l]);var a=e.i(89171),o=e.i(362693),i=e.i(856949),n=e.i(322632),s=t([i]);[i]=s.then?(await s)():s;let c=n.z.object({batchId:n.z.string().uuid(),concurrency:n.z.number().int().min(1).max(5).optional()});async function l(e){try{let t=await e.json(),{batchId:r,concurrency:n=2}=c.parse(t),{data:s,error:l}=await o.supabaseServer.from("resume_batches").select("id, user_id, status, total").eq("id",r).single();if(l||!s)return a.NextResponse.json({error:"Batch not found"},{status:404});if("created"!==s.status)return a.NextResponse.json({error:"Batch is not in created status"},{status:400});if(0===s.total)return a.NextResponse.json({error:"Batch has no items to process"},{status:400});return setImmediate(async()=>{try{await (0,i.runBatch)(r,{concurrency:n})}catch(e){console.error(`Error running batch ${r}:`,e)}}),a.NextResponse.json({started:!0,batchId:r,concurrency:n,message:"Batch processing started"})}catch(e){if(console.error("Error in run batch:",e),e instanceof n.z.ZodError)return a.NextResponse.json({error:"Invalid request data",details:e.errors},{status:400});return a.NextResponse.json({error:"Internal server error"},{status:500})}}r()}catch(e){r(e)}},!1),939491,e=>e.a(async(t,r)=>{try{e.s(["handler",()=>v,"patchFetch",()=>w,"routeModule",()=>T,"serverHooks",()=>R,"workAsyncStorage",()=>j,"workUnitAsyncStorage",()=>E]);var a=e.i(747909),o=e.i(174017),i=e.i(996250),n=e.i(759756),s=e.i(561916),l=e.i(869741),c=e.i(316795),d=e.i(487718),u=e.i(995169),m=e.i(47587),p=e.i(666012),h=e.i(570101),f=e.i(626937),g=e.i(10372),y=e.i(193695);e.i(52474);var b=e.i(600220),x=e.i(225124),S=t([x]);[x]=S.then?(await S)():S;let T=new a.AppRouteRouteModule({definition:{kind:o.RouteKind.APP_ROUTE,page:"/api/batch/run/route",pathname:"/api/batch/run",filename:"route",bundlePath:""},distDir:".next",relativeProjectDir:"",resolvedPagePath:"[project]/src/app/api/batch/run/route.ts",nextConfigOutput:"",userland:x}),{workAsyncStorage:j,workUnitAsyncStorage:E,serverHooks:R}=T;function w(){return(0,i.patchFetch)({workAsyncStorage:j,workUnitAsyncStorage:E})}async function v(e,t,r){var a;let i="/api/batch/run/route";i=i.replace(/\/index$/,"")||"/";let x=await T.prepare(e,t,{srcPage:i,multiZoneDraftMode:!1});if(!x)return t.statusCode=400,t.end("Bad Request"),null==r.waitUntil||r.waitUntil.call(r,Promise.resolve()),null;let{buildId:S,params:w,nextConfig:v,isDraftMode:j,prerenderManifest:E,routerServerContext:R,isOnDemandRevalidate:C,revalidateOnlyGenerated:_,resolvedPathname:B}=x,k=(0,l.normalizeAppPath)(i),$=!!(E.dynamicRoutes[k]||E.routes[B]);if($&&!j){let e=!!E.routes[B],t=E.dynamicRoutes[k];if(t&&!1===t.fallback&&!e)throw new y.NoFallbackError}let H=null;!$||T.isDev||j||(H=B,H="/index"===H?"/":H);let I=!0===T.isDev||!$,z=$&&!I,F=e.method||"GET",N=(0,s.getTracer)(),P=N.getActiveScopeSpan(),A={params:w,prerenderManifest:E,renderOpts:{experimental:{cacheComponents:!!v.experimental.cacheComponents,authInterrupts:!!v.experimental.authInterrupts},supportsDynamicResponse:I,incrementalCache:(0,n.getRequestMeta)(e,"incrementalCache"),cacheLifeProfiles:null==(a=v.experimental)?void 0:a.cacheLife,isRevalidate:z,waitUntil:r.waitUntil,onClose:e=>{t.on("close",e)},onAfterTaskError:void 0,onInstrumentationRequestError:(t,r,a)=>T.onRequestError(e,t,a,R)},sharedContext:{buildId:S}},O=new c.NodeNextRequest(e),D=new c.NodeNextResponse(t),q=d.NextRequestAdapter.fromNodeNextRequest(O,(0,d.signalFromNodeResponse)(t));try{let a=async r=>T.handle(q,A).finally(()=>{if(!r)return;r.setAttributes({"http.status_code":t.statusCode,"next.rsc":!1});let a=N.getRootSpanAttributes();if(!a)return;if(a.get("next.span_type")!==u.BaseServerSpan.handleRequest)return void console.warn(`Unexpected root span type '${a.get("next.span_type")}'. Please report this Next.js issue https://github.com/vercel/next.js`);let o=a.get("next.route");if(o){let e=`${F} ${o}`;r.setAttributes({"next.route":o,"http.route":o,"next.span_name":e}),r.updateName(e)}else r.updateName(`${F} ${e.url}`)}),l=async s=>{var l,c;let d=async({previousCacheEntry:o})=>{try{if(!(0,n.getRequestMeta)(e,"minimalMode")&&C&&_&&!o)return t.statusCode=404,t.setHeader("x-nextjs-cache","REVALIDATED"),t.end("This page could not be found"),null;let i=await a(s);e.fetchMetrics=A.renderOpts.fetchMetrics;let l=A.renderOpts.pendingWaitUntil;l&&r.waitUntil&&(r.waitUntil(l),l=void 0);let c=A.renderOpts.collectedTags;if(!$)return await (0,p.sendResponse)(O,D,i,A.renderOpts.pendingWaitUntil),null;{let e=await i.blob(),t=(0,h.toNodeOutgoingHttpHeaders)(i.headers);c&&(t[g.NEXT_CACHE_TAGS_HEADER]=c),!t["content-type"]&&e.type&&(t["content-type"]=e.type);let r=void 0!==A.renderOpts.collectedRevalidate&&!(A.renderOpts.collectedRevalidate>=g.INFINITE_CACHE)&&A.renderOpts.collectedRevalidate,a=void 0===A.renderOpts.collectedExpire||A.renderOpts.collectedExpire>=g.INFINITE_CACHE?void 0:A.renderOpts.collectedExpire;return{value:{kind:b.CachedRouteKind.APP_ROUTE,status:i.status,body:Buffer.from(await e.arrayBuffer()),headers:t},cacheControl:{revalidate:r,expire:a}}}}catch(t){throw(null==o?void 0:o.isStale)&&await T.onRequestError(e,t,{routerKind:"App Router",routePath:i,routeType:"route",revalidateReason:(0,m.getRevalidateReason)({isRevalidate:z,isOnDemandRevalidate:C})},R),t}},u=await T.handleResponse({req:e,nextConfig:v,cacheKey:H,routeKind:o.RouteKind.APP_ROUTE,isFallback:!1,prerenderManifest:E,isRoutePPREnabled:!1,isOnDemandRevalidate:C,revalidateOnlyGenerated:_,responseGenerator:d,waitUntil:r.waitUntil});if(!$)return null;if((null==u||null==(l=u.value)?void 0:l.kind)!==b.CachedRouteKind.APP_ROUTE)throw Object.defineProperty(Error(`Invariant: app-route received invalid cache entry ${null==u||null==(c=u.value)?void 0:c.kind}`),"__NEXT_ERROR_CODE",{value:"E701",enumerable:!1,configurable:!0});(0,n.getRequestMeta)(e,"minimalMode")||t.setHeader("x-nextjs-cache",C?"REVALIDATED":u.isMiss?"MISS":u.isStale?"STALE":"HIT"),j&&t.setHeader("Cache-Control","private, no-cache, no-store, max-age=0, must-revalidate");let y=(0,h.fromNodeOutgoingHttpHeaders)(u.value.headers);return(0,n.getRequestMeta)(e,"minimalMode")&&$||y.delete(g.NEXT_CACHE_TAGS_HEADER),!u.cacheControl||t.getHeader("Cache-Control")||y.get("Cache-Control")||y.set("Cache-Control",(0,f.getCacheControlHeader)(u.cacheControl)),await (0,p.sendResponse)(O,D,new Response(u.value.body,{headers:y,status:u.value.status||200})),null};P?await l(P):await N.withPropagatedContext(e.headers,()=>N.trace(u.BaseServerSpan.handleRequest,{spanName:`${F} ${e.url}`,kind:s.SpanKind.SERVER,attributes:{"http.method":F,"http.target":e.url}},l))}catch(t){if(P||t instanceof y.NoFallbackError||await T.onRequestError(e,t,{routerKind:"App Router",routePath:k,routeType:"route",revalidateReason:(0,m.getRevalidateReason)({isRevalidate:z,isOnDemandRevalidate:C})}),$)throw t;return await (0,p.sendResponse)(O,D,new Response(null,{status:500})),null}}r()}catch(e){r(e)}},!1)];

//# sourceMappingURL=%5Broot-of-the-server%5D__79486bce._.js.map