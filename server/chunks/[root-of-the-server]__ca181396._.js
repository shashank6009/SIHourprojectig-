module.exports=[688947,(e,t,r)=>{t.exports=e.x("stream",()=>require("stream"))},792509,(e,t,r)=>{t.exports=e.x("url",()=>require("url"))},921517,(e,t,r)=>{t.exports=e.x("http",()=>require("http"))},524836,(e,t,r)=>{t.exports=e.x("https",()=>require("https"))},406461,(e,t,r)=>{t.exports=e.x("zlib",()=>require("zlib"))},918622,(e,t,r)=>{t.exports=e.x("next/dist/compiled/next-server/app-page-turbo.runtime.prod.js",()=>require("next/dist/compiled/next-server/app-page-turbo.runtime.prod.js"))},556704,(e,t,r)=>{t.exports=e.x("next/dist/server/app-render/work-async-storage.external.js",()=>require("next/dist/server/app-render/work-async-storage.external.js"))},832319,(e,t,r)=>{t.exports=e.x("next/dist/server/app-render/work-unit-async-storage.external.js",()=>require("next/dist/server/app-render/work-unit-async-storage.external.js"))},120635,(e,t,r)=>{t.exports=e.x("next/dist/server/app-render/action-async-storage.external.js",()=>require("next/dist/server/app-render/action-async-storage.external.js"))},324725,(e,t,r)=>{t.exports=e.x("next/dist/server/app-render/after-task-async-storage.external.js",()=>require("next/dist/server/app-render/after-task-async-storage.external.js"))},270406,(e,t,r)=>{t.exports=e.x("next/dist/compiled/@opentelemetry/api",()=>require("next/dist/compiled/@opentelemetry/api"))},193695,(e,t,r)=>{t.exports=e.x("next/dist/shared/lib/no-fallback-error.external.js",()=>require("next/dist/shared/lib/no-fallback-error.external.js"))},961724,(e,t,r)=>{t.exports=e.x("next/dist/compiled/next-server/app-route-turbo.runtime.prod.js",()=>require("next/dist/compiled/next-server/app-route-turbo.runtime.prod.js"))},84690,e=>{"use strict";async function t(e){let t=e.text||"",r="";if(e.url&&!e.text)try{let a=await fetch(e.url,{headers:{"User-Agent":"Mozilla/5.0 (compatible; ResumeCoPilot/1.0)"},signal:AbortSignal.timeout(1e4)});if(!a.ok)throw Error(`Failed to fetch job description from URL: ${a.status}`);(t=(r=await a.text()).replace(/<script[^>]*>.*?<\/script>/gi,"").replace(/<style[^>]*>.*?<\/style>/gi,"").replace(/<[^>]*>/g," ").replace(/\s+/g," ").trim()).length>2e4&&(t=t.substring(0,2e4)+"... [truncated]")}catch(e){throw Error(`Failed to fetch job description from URL: ${e instanceof Error?e.message:"Unknown error"}`)}if(!t||0===t.trim().length)throw Error("No job description text available");let a=function(e,t){let r=e.match(/<title[^>]*>([^<]+)<\/title>/i);if(r){let e=r[1].toLowerCase(),t=e.match(/(?:at|@)\s*([^|\-\n]+)/);if(t)return t[1].trim().replace(/[^\w\s]/g,"").trim();let a=e.match(/^([^|\-\n]+)\s*[-|]/);if(a)return a[1].trim().replace(/[^\w\s]/g,"").trim()}let a=e.match(/<h1[^>]*>([^<]+)<\/h1>/i);if(a){let e=a[1].toLowerCase().match(/(?:at|@)\s*([^|\-\n]+)/);if(e)return e[1].trim().replace(/[^\w\s]/g,"").trim()}let o=e.match(/<meta[^>]*name=["']description["'][^>]*content=["']([^"']+)["']/i);if(o){let e=o[1].toLowerCase().match(/(?:at|@)\s*([^|\-\n]+)/);if(e)return e[1].trim().replace(/[^\w\s]/g,"").trim()}for(let e of[/(?:at|@)\s*([A-Z][a-zA-Z\s&]+(?:Inc|Corp|LLC|Ltd|Company|Technologies|Systems|Solutions|Group|Partners)?)/i,/([A-Z][a-zA-Z\s&]+(?:Inc|Corp|LLC|Ltd|Company|Technologies|Systems|Solutions|Group|Partners)?)\s*(?:is|seeks|looking)/i]){let r=t.match(e);if(r&&r[1].length>2&&r[1].length<50)return r[1].trim()}}(r,t),o=function(e,t){let r=e.match(/<title[^>]*>([^<]+)<\/title>/i);if(r){let e=r[1],t=e.match(/^([^|@\-]+?)(?:\s*(?:at|@|\-))/);if(t)return t[1].trim();let a=e.match(/[^\-\|]+[\-\|]\s*([^\-\|]+)/);if(a)return a[1].trim()}let a=e.match(/<h1[^>]*>([^<]+)<\/h1>/i);if(a){let e=a[1].match(/^([^|@\-]+?)(?:\s*(?:at|@|\-))/);if(e)return e[1].trim()}for(let e of[/(?:position|role|title)[:\s]+([A-Z][a-zA-Z\s]+(?:Engineer|Developer|Manager|Analyst|Specialist|Coordinator|Director|Lead|Senior|Junior)?)/i,/(?:looking for|seeking|hiring)\s+([A-Z][a-zA-Z\s]+(?:Engineer|Developer|Manager|Analyst|Specialist|Coordinator|Director|Lead|Senior|Junior)?)/i]){let r=t.match(e);if(r&&r[1].length>3&&r[1].length<50)return r[1].trim()}}(r,t),n=function(e){let t=new Set(["the","and","or","but","in","on","at","to","for","of","with","by","a","an","as","is","was","are","were","be","been","being","have","has","had","do","does","did","will","would","could","should","this","that","these","those","i","you","he","she","it","we","they","me","him","her","us","them","my","your","his","her","its","our","their","can","may","must","shall","might","could","would","should","will","not","no","yes","all","any","some","many","much","few","little","more","most","less","least","other","another","each","every","both","either","neither","one","two","first","second","last","next","previous","new","old","good","bad","great","small","large","big","long","short","high","low","early","late","fast","slow","easy","hard","simple","complex","important","necessary","possible","available","required","preferred","experience","skills","ability","knowledge","understanding","familiarity","responsibilities","duties","tasks","projects","team","work","job","position","role","company","organization","department","office","location","remote","full","time","part","contract","permanent","temporary","salary","benefits","opportunity","career","growth","development","learning","training","bachelor","master","degree","diploma","certification","license","years","year","months","month","weeks","week","days","day","monday","tuesday","wednesday","thursday","friday","saturday","sunday","january","february","march","april","may","june","july","august","september","october","november","december"]),r=e.toLowerCase().replace(/[^\w\s]/g," ").split(/\s+/).filter(e=>e.length>=3&&e.length<=20&&!t.has(e)&&!/^\d+$/.test(e)),a=new Map;return r.forEach(e=>{a.set(e,(a.get(e)||0)+1)}),Array.from(a.entries()).sort((e,t)=>t[1]-e[1]).slice(0,25).map(([e])=>e)}(t);return{company:a,role:o,jdText:t.trim(),keywords:n}}e.s(["normalizeJD",()=>t])},543104,(e,t,r)=>{},238530,e=>{"use strict";e.s(["handler",()=>_,"patchFetch",()=>S,"routeModule",()=>C,"serverHooks",()=>k,"workAsyncStorage",()=>j,"workUnitAsyncStorage",()=>A],238530);var t=e.i(747909),r=e.i(174017),a=e.i(996250),o=e.i(759756),n=e.i(561916),s=e.i(869741),i=e.i(316795),l=e.i(487718),u=e.i(995169),d=e.i(47587),c=e.i(666012),p=e.i(570101),h=e.i(626937),m=e.i(10372),g=e.i(193695);e.i(52474);var x=e.i(600220);e.s(["POST",()=>R],407513);var f=e.i(89171),y=e.i(362693),w=e.i(84690),v=e.i(322632);let b=v.z.object({batchId:v.z.string().uuid(),items:v.z.array(v.z.object({url:v.z.string().url().optional(),text:v.z.string().optional(),company:v.z.string().optional(),role:v.z.string().optional()})).min(1).max(parseInt(process.env.BATCH_MAX_ITEMS||"25"))});async function R(e){try{let t=await e.json(),{batchId:r,items:a}=b.parse(t),{data:o,error:n}=await y.supabaseServer.from("resume_batches").select("id, user_id, status").eq("id",r).single();if(n||!o)return f.NextResponse.json({error:"Batch not found"},{status:404});if("created"!==o.status)return f.NextResponse.json({error:"Batch is not in created status"},{status:400});let s=a.filter((e,t,r)=>!e.url||r.findIndex(t=>t.url===e.url)===t),i=[],l=[];for(let e of s)try{let t={company:e.company,role:e.role,jdText:e.text,keywords:[]};if(e.url&&!e.text)try{let r=await (0,w.normalizeJD)({url:e.url});t={company:r.company||e.company,role:r.role||e.role,jdText:r.jdText,keywords:r.keywords}}catch(t){l.push({item:e,error:`Failed to normalize JD: ${t instanceof Error?t.message:"Unknown error"}`});continue}else if(e.text){let r=await (0,w.normalizeJD)({text:e.text});t.keywords=r.keywords}i.push({batch_id:r,company:t.company,role:t.role,jd_url:e.url,jd_text:t.jdText,keywords:t.keywords,status:"queued",created_at:new Date().toISOString(),updated_at:new Date().toISOString()})}catch(t){l.push({item:e,error:`Failed to process item: ${t instanceof Error?t.message:"Unknown error"}`})}if(i.length>0){let{error:e}=await y.supabaseServer.from("resume_batch_items").insert(i);if(e)return console.error("Error inserting batch items:",e),f.NextResponse.json({error:"Failed to insert batch items"},{status:500})}let{error:u}=await y.supabaseServer.from("resume_batches").update({total:i.length,updated_at:new Date().toISOString()}).eq("id",r);return u&&console.error("Error updating batch total:",u),f.NextResponse.json({success:!0,totalItems:i.length,errors:l.length>0?l:void 0,message:`Successfully ingested ${i.length} items${l.length>0?` with ${l.length} errors`:""}`})}catch(e){if(console.error("Error in ingest batch:",e),e instanceof v.z.ZodError)return f.NextResponse.json({error:"Invalid request data",details:e.errors},{status:400});return f.NextResponse.json({error:"Internal server error"},{status:500})}}var E=e.i(407513);let C=new t.AppRouteRouteModule({definition:{kind:r.RouteKind.APP_ROUTE,page:"/api/batch/ingest/route",pathname:"/api/batch/ingest",filename:"route",bundlePath:""},distDir:".next",relativeProjectDir:"",resolvedPagePath:"[project]/src/app/api/batch/ingest/route.ts",nextConfigOutput:"",userland:E}),{workAsyncStorage:j,workUnitAsyncStorage:A,serverHooks:k}=C;function S(){return(0,a.patchFetch)({workAsyncStorage:j,workUnitAsyncStorage:A})}async function _(e,t,a){var f;let y="/api/batch/ingest/route";y=y.replace(/\/index$/,"")||"/";let w=await C.prepare(e,t,{srcPage:y,multiZoneDraftMode:!1});if(!w)return t.statusCode=400,t.end("Bad Request"),null==a.waitUntil||a.waitUntil.call(a,Promise.resolve()),null;let{buildId:v,params:b,nextConfig:R,isDraftMode:E,prerenderManifest:j,routerServerContext:A,isOnDemandRevalidate:k,revalidateOnlyGenerated:S,resolvedPathname:_}=w,q=(0,s.normalizeAppPath)(y),T=!!(j.dynamicRoutes[q]||j.routes[_]);if(T&&!E){let e=!!j.routes[_],t=j.dynamicRoutes[q];if(t&&!1===t.fallback&&!e)throw new g.NoFallbackError}let N=null;!T||C.isDev||E||(N="/index"===(N=_)?"/":N);let P=!0===C.isDev||!T,I=T&&!P,O=e.method||"GET",z=(0,n.getTracer)(),D=z.getActiveScopeSpan(),U={params:b,prerenderManifest:j,renderOpts:{experimental:{cacheComponents:!!R.experimental.cacheComponents,authInterrupts:!!R.experimental.authInterrupts},supportsDynamicResponse:P,incrementalCache:(0,o.getRequestMeta)(e,"incrementalCache"),cacheLifeProfiles:null==(f=R.experimental)?void 0:f.cacheLife,isRevalidate:I,waitUntil:a.waitUntil,onClose:e=>{t.on("close",e)},onAfterTaskError:void 0,onInstrumentationRequestError:(t,r,a)=>C.onRequestError(e,t,a,A)},sharedContext:{buildId:v}},M=new i.NodeNextRequest(e),L=new i.NodeNextResponse(t),H=l.NextRequestAdapter.fromNodeNextRequest(M,(0,l.signalFromNodeResponse)(t));try{let s=async r=>C.handle(H,U).finally(()=>{if(!r)return;r.setAttributes({"http.status_code":t.statusCode,"next.rsc":!1});let a=z.getRootSpanAttributes();if(!a)return;if(a.get("next.span_type")!==u.BaseServerSpan.handleRequest)return void console.warn(`Unexpected root span type '${a.get("next.span_type")}'. Please report this Next.js issue https://github.com/vercel/next.js`);let o=a.get("next.route");if(o){let e=`${O} ${o}`;r.setAttributes({"next.route":o,"http.route":o,"next.span_name":e}),r.updateName(e)}else r.updateName(`${O} ${e.url}`)}),i=async n=>{var i,l;let u=async({previousCacheEntry:r})=>{try{if(!(0,o.getRequestMeta)(e,"minimalMode")&&k&&S&&!r)return t.statusCode=404,t.setHeader("x-nextjs-cache","REVALIDATED"),t.end("This page could not be found"),null;let i=await s(n);e.fetchMetrics=U.renderOpts.fetchMetrics;let l=U.renderOpts.pendingWaitUntil;l&&a.waitUntil&&(a.waitUntil(l),l=void 0);let u=U.renderOpts.collectedTags;if(!T)return await (0,c.sendResponse)(M,L,i,U.renderOpts.pendingWaitUntil),null;{let e=await i.blob(),t=(0,p.toNodeOutgoingHttpHeaders)(i.headers);u&&(t[m.NEXT_CACHE_TAGS_HEADER]=u),!t["content-type"]&&e.type&&(t["content-type"]=e.type);let r=void 0!==U.renderOpts.collectedRevalidate&&!(U.renderOpts.collectedRevalidate>=m.INFINITE_CACHE)&&U.renderOpts.collectedRevalidate,a=void 0===U.renderOpts.collectedExpire||U.renderOpts.collectedExpire>=m.INFINITE_CACHE?void 0:U.renderOpts.collectedExpire;return{value:{kind:x.CachedRouteKind.APP_ROUTE,status:i.status,body:Buffer.from(await e.arrayBuffer()),headers:t},cacheControl:{revalidate:r,expire:a}}}}catch(t){throw(null==r?void 0:r.isStale)&&await C.onRequestError(e,t,{routerKind:"App Router",routePath:y,routeType:"route",revalidateReason:(0,d.getRevalidateReason)({isRevalidate:I,isOnDemandRevalidate:k})},A),t}},g=await C.handleResponse({req:e,nextConfig:R,cacheKey:N,routeKind:r.RouteKind.APP_ROUTE,isFallback:!1,prerenderManifest:j,isRoutePPREnabled:!1,isOnDemandRevalidate:k,revalidateOnlyGenerated:S,responseGenerator:u,waitUntil:a.waitUntil});if(!T)return null;if((null==g||null==(i=g.value)?void 0:i.kind)!==x.CachedRouteKind.APP_ROUTE)throw Object.defineProperty(Error(`Invariant: app-route received invalid cache entry ${null==g||null==(l=g.value)?void 0:l.kind}`),"__NEXT_ERROR_CODE",{value:"E701",enumerable:!1,configurable:!0});(0,o.getRequestMeta)(e,"minimalMode")||t.setHeader("x-nextjs-cache",k?"REVALIDATED":g.isMiss?"MISS":g.isStale?"STALE":"HIT"),E&&t.setHeader("Cache-Control","private, no-cache, no-store, max-age=0, must-revalidate");let f=(0,p.fromNodeOutgoingHttpHeaders)(g.value.headers);return(0,o.getRequestMeta)(e,"minimalMode")&&T||f.delete(m.NEXT_CACHE_TAGS_HEADER),!g.cacheControl||t.getHeader("Cache-Control")||f.get("Cache-Control")||f.set("Cache-Control",(0,h.getCacheControlHeader)(g.cacheControl)),await (0,c.sendResponse)(M,L,new Response(g.value.body,{headers:f,status:g.value.status||200})),null};D?await i(D):await z.withPropagatedContext(e.headers,()=>z.trace(u.BaseServerSpan.handleRequest,{spanName:`${O} ${e.url}`,kind:n.SpanKind.SERVER,attributes:{"http.method":O,"http.target":e.url}},i))}catch(t){if(D||t instanceof g.NoFallbackError||await C.onRequestError(e,t,{routerKind:"App Router",routePath:q,routeType:"route",revalidateReason:(0,d.getRevalidateReason)({isRevalidate:I,isOnDemandRevalidate:k})}),T)throw t;return await (0,c.sendResponse)(M,L,new Response(null,{status:500})),null}}},236145,e=>{e.v(e=>Promise.resolve().then(()=>e(902808)))}];

//# sourceMappingURL=%5Broot-of-the-server%5D__ca181396._.js.map