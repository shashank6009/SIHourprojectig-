module.exports=[224361,(e,t,r)=>{t.exports=e.x("util",()=>require("util"))},254799,(e,t,r)=>{t.exports=e.x("crypto",()=>require("crypto"))},688947,(e,t,r)=>{t.exports=e.x("stream",()=>require("stream"))},792509,(e,t,r)=>{t.exports=e.x("url",()=>require("url"))},921517,(e,t,r)=>{t.exports=e.x("http",()=>require("http"))},524836,(e,t,r)=>{t.exports=e.x("https",()=>require("https"))},406461,(e,t,r)=>{t.exports=e.x("zlib",()=>require("zlib"))},918622,(e,t,r)=>{t.exports=e.x("next/dist/compiled/next-server/app-page-turbo.runtime.prod.js",()=>require("next/dist/compiled/next-server/app-page-turbo.runtime.prod.js"))},556704,(e,t,r)=>{t.exports=e.x("next/dist/server/app-render/work-async-storage.external.js",()=>require("next/dist/server/app-render/work-async-storage.external.js"))},832319,(e,t,r)=>{t.exports=e.x("next/dist/server/app-render/work-unit-async-storage.external.js",()=>require("next/dist/server/app-render/work-unit-async-storage.external.js"))},120635,(e,t,r)=>{t.exports=e.x("next/dist/server/app-render/action-async-storage.external.js",()=>require("next/dist/server/app-render/action-async-storage.external.js"))},324725,(e,t,r)=>{t.exports=e.x("next/dist/server/app-render/after-task-async-storage.external.js",()=>require("next/dist/server/app-render/after-task-async-storage.external.js"))},270406,(e,t,r)=>{t.exports=e.x("next/dist/compiled/@opentelemetry/api",()=>require("next/dist/compiled/@opentelemetry/api"))},193695,(e,t,r)=>{t.exports=e.x("next/dist/shared/lib/no-fallback-error.external.js",()=>require("next/dist/shared/lib/no-fallback-error.external.js"))},961724,(e,t,r)=>{t.exports=e.x("next/dist/compiled/next-server/app-route-turbo.runtime.prod.js",()=>require("next/dist/compiled/next-server/app-route-turbo.runtime.prod.js"))},50381,e=>{"use strict";e.s(["trackEvent",()=>o,"trackModelRun",()=>s],50381);var t=e.i(362693),r=e.i(254799);function a(e){return e?(0,r.createHash)("sha256").update(e).digest("hex"):""}function n(e){if(!e)return"";let t=e;return(t=(t=(t=(t=(t=(t=t.replace(/\b[A-Za-z0-9._%+-]+@[A-Za-z0-9.-]+\.[A-Z|a-z]{2,}\b/g,"[email]")).replace(/\b\d{3}[-.]?\d{3}[-.]?\d{4}\b/g,"[phone]")).replace(/\b\(\d{3}\)\s*\d{3}[-.]?\d{4}\b/g,"[phone]")).replace(/\b\d{3}\s\d{3}\s\d{4}\b/g,"[phone]")).replace(/\b\d{3}-\d{2}-\d{4}\b/g,"[ssn]")).replace(/\b\d{9}\b/g,"[ssn]")).replace(/\b\d{4}[\s-]?\d{4}[\s-]?\d{4}[\s-]?\d{4}\b/g,"[card]")}async function o(e){try{let{userId:r,event:o,resumeVersionId:s,metadata:i={}}=e,l=a(r),u=function e(t){if(!t||"object"!=typeof t)return{};let r={};for(let[a,o]of Object.entries(t))a.length>50||/password|secret|token|key/i.test(a)||("string"==typeof o?r[a]=n(o).substring(0,500):"number"==typeof o||"boolean"==typeof o?r[a]=o:Array.isArray(o)?r[a]=o.slice(0,10).map(e=>"string"==typeof e?n(e).substring(0,100):e):"object"==typeof o&&null!==o&&(r[a]=e(o)));if(JSON.stringify(r).length>2e3){let e=Object.entries(r).sort((e,t)=>JSON.stringify(t[1]).length-JSON.stringify(e[1]).length),t={},a=0;for(let[r,n]of e){let e=JSON.stringify({[r]:n}).length;a+e<1800&&(t[r]=n,a+=e)}return t}return r}(i),{error:c}=await t.supabaseServer.from("resume_events").insert({user_hash:l,resume_version_id:s||null,event_type:o,metadata:u});c&&console.error("Failed to track event:",c)}catch(e){console.error("Analytics tracking error:",e)}}async function s(e){try{let{userId:r,resumeVersionId:n,provider:o,model:s,promptKey:i,tokensIn:l,tokensOut:u,atsScore:c,missingKeywords:p}=e,d=a(r),{error:f}=await t.supabaseServer.from("resume_model_runs").insert({user_hash:d,resume_version_id:n||null,provider:o,model:s,prompt_key:i,tokens_in:l||0,tokens_out:u||0,ats_score:c||null,missing_keywords:p||0});f&&console.error("Failed to track model run:",f)}catch(e){console.error("Model run tracking error:",e)}}},427699,(e,t,r)=>{t.exports=e.x("events",()=>require("events"))},500874,(e,t,r)=>{t.exports=e.x("buffer",()=>require("buffer"))},223469,(e,t,r)=>{var a=e.r(500874),n=a.Buffer;function o(e,t){for(var r in e)t[r]=e[r]}function s(e,t,r){return n(e,t,r)}n.from&&n.alloc&&n.allocUnsafe&&n.allocUnsafeSlow?t.exports=a:(o(a,r),r.Buffer=s),o(n,s),s.from=function(e,t,r){if("number"==typeof e)throw TypeError("Argument must not be a number");return n(e,t,r)},s.alloc=function(e,t,r){if("number"!=typeof e)throw TypeError("Argument must be a number");var a=n(e);return void 0!==t?"string"==typeof r?a.fill(t,r):a.fill(t):a.fill(0),a},s.allocUnsafe=function(e){if("number"!=typeof e)throw TypeError("Argument must be a number");return n(e)},s.allocUnsafeSlow=function(e){if("number"!=typeof e)throw TypeError("Argument must be a number");return a.SlowBuffer(e)}},909503,(e,t,r)=>{},221057,e=>{"use strict";e.s(["handler",()=>j,"patchFetch",()=>k,"routeModule",()=>R,"serverHooks",()=>C,"workAsyncStorage",()=>E,"workUnitAsyncStorage",()=>A],221057);var t=e.i(747909),r=e.i(174017),a=e.i(996250),n=e.i(759756),o=e.i(561916),s=e.i(869741),i=e.i(316795),l=e.i(487718),u=e.i(995169),c=e.i(47587),p=e.i(666012),d=e.i(570101),f=e.i(626937),h=e.i(10372),m=e.i(193695);e.i(52474);var x=e.i(600220);e.s(["GET",()=>_],457646);var g=e.i(89171),v=e.i(362693),b=e.i(50381),y=e.i(869411);async function _(e){try{let{searchParams:t}=new URL(e.url),r=t.get("batchId");if(!r)return g.NextResponse.json({error:"batchId parameter is required"},{status:400});let{data:a,error:n}=await v.supabaseServer.from("resume_batches").select("*").eq("id",r).single();if(n||!a)return g.NextResponse.json({error:"Batch not found"},{status:404});let{data:o,error:s}=await v.supabaseServer.from("resume_batch_items").select("*").eq("batch_id",r).eq("status","done").order("created_at",{ascending:!0});if(s)return console.error("Error fetching batch items:",s),g.NextResponse.json({error:"Failed to fetch batch items"},{status:500});if(!o||0===o.length)return g.NextResponse.json({error:"No completed items found in batch"},{status:404});let i=new y.default,l=[];for(let e=0;e<o.length;e++){let t=o[e],r=t.company||"Unknown",a=t.role||"Position",n=r.replace(/[^a-zA-Z0-9-]/g,"-").toLowerCase(),s=a.replace(/[^a-zA-Z0-9-]/g,"-").toLowerCase(),u=`${e+1}_${n}_${s}`;if(t.assets){let e=t.assets;if(e.resumePdf)try{let t=await fetch(e.resumePdf);if(t.ok){let e=await t.arrayBuffer();i.file(`${u}/resume.pdf`,e)}}catch(e){console.warn(`Failed to fetch resume PDF for item ${t.id}:`,e)}if(e.coverPdf)try{let t=await fetch(e.coverPdf);if(t.ok){let e=await t.arrayBuffer();i.file(`${u}/cover.pdf`,e)}}catch(e){console.warn(`Failed to fetch cover PDF for item ${t.id}:`,e)}e.emailTxt&&i.file(`${u}/email.txt`,e.emailTxt),e.inmailTxt&&i.file(`${u}/inmail.txt`,e.inmailTxt)}l.push({company:t.company||"",role:t.role||"",jd_url:t.jd_url||"",ats_score:t.ats_score||0,resume_url:t.assets?.resumePdf||"",cover_url:t.assets?.coverPdf||"",email_path:`${u}/email.txt`,inmail_path:`${u}/inmail.txt`,status:t.status,outreach_status:t.assets?.trackerEvents?.slice(-1)[0]?.status||"Not Started",updated_at:t.updated_at})}let u=["company","role","jd_url","ats_score","resume_url","cover_url","email_path","inmail_path","status","outreach_status","updated_at"],c=[u.join(","),...l.map(e=>u.map(t=>{let r=e[t]||"";return"string"==typeof r&&r.includes(",")?`"${r.replace(/"/g,'""')}"`:r}).join(","))].join("\n");i.file("tracker.csv",c);let p=await i.generateAsync({type:"nodebuffer"});return await (0,b.trackEvent)({userId:a.user_id,event:"BATCH_EXPORTED",metadata:{batchId:a.id,itemCount:o.length,totalSize:p.length}}),new g.NextResponse(p,{headers:{"Content-Type":"application/zip","Content-Disposition":`attachment; filename="batch_${a.label.replace(/[^a-zA-Z0-9-]/g,"_")}_${new Date().toISOString().split("T")[0]}.zip"`,"Content-Length":p.length.toString()}})}catch(e){return console.error("Error in batch export:",e),g.NextResponse.json({error:"Internal server error"},{status:500})}}var w=e.i(457646);let R=new t.AppRouteRouteModule({definition:{kind:r.RouteKind.APP_ROUTE,page:"/api/batch/export/route",pathname:"/api/batch/export",filename:"route",bundlePath:""},distDir:".next",relativeProjectDir:"",resolvedPagePath:"[project]/src/app/api/batch/export/route.ts",nextConfigOutput:"",userland:w}),{workAsyncStorage:E,workUnitAsyncStorage:A,serverHooks:C}=R;function k(){return(0,a.patchFetch)({workAsyncStorage:E,workUnitAsyncStorage:A})}async function j(e,t,a){var g;let v="/api/batch/export/route";v=v.replace(/\/index$/,"")||"/";let b=await R.prepare(e,t,{srcPage:v,multiZoneDraftMode:!1});if(!b)return t.statusCode=400,t.end("Bad Request"),null==a.waitUntil||a.waitUntil.call(a,Promise.resolve()),null;let{buildId:y,params:_,nextConfig:w,isDraftMode:E,prerenderManifest:A,routerServerContext:C,isOnDemandRevalidate:k,revalidateOnlyGenerated:j,resolvedPathname:q}=b,N=(0,s.normalizeAppPath)(v),T=!!(A.dynamicRoutes[N]||A.routes[q]);if(T&&!E){let e=!!A.routes[q],t=A.dynamicRoutes[N];if(t&&!1===t.fallback&&!e)throw new m.NoFallbackError}let S=null;!T||R.isDev||E||(S="/index"===(S=q)?"/":S);let P=!0===R.isDev||!T,O=T&&!P,$=e.method||"GET",U=(0,o.getTracer)(),I=U.getActiveScopeSpan(),H={params:_,prerenderManifest:A,renderOpts:{experimental:{cacheComponents:!!w.experimental.cacheComponents,authInterrupts:!!w.experimental.authInterrupts},supportsDynamicResponse:P,incrementalCache:(0,n.getRequestMeta)(e,"incrementalCache"),cacheLifeProfiles:null==(g=w.experimental)?void 0:g.cacheLife,isRevalidate:O,waitUntil:a.waitUntil,onClose:e=>{t.on("close",e)},onAfterTaskError:void 0,onInstrumentationRequestError:(t,r,a)=>R.onRequestError(e,t,a,C)},sharedContext:{buildId:y}},D=new i.NodeNextRequest(e),M=new i.NodeNextResponse(t),F=l.NextRequestAdapter.fromNodeNextRequest(D,(0,l.signalFromNodeResponse)(t));try{let s=async r=>R.handle(F,H).finally(()=>{if(!r)return;r.setAttributes({"http.status_code":t.statusCode,"next.rsc":!1});let a=U.getRootSpanAttributes();if(!a)return;if(a.get("next.span_type")!==u.BaseServerSpan.handleRequest)return void console.warn(`Unexpected root span type '${a.get("next.span_type")}'. Please report this Next.js issue https://github.com/vercel/next.js`);let n=a.get("next.route");if(n){let e=`${$} ${n}`;r.setAttributes({"next.route":n,"http.route":n,"next.span_name":e}),r.updateName(e)}else r.updateName(`${$} ${e.url}`)}),i=async o=>{var i,l;let u=async({previousCacheEntry:r})=>{try{if(!(0,n.getRequestMeta)(e,"minimalMode")&&k&&j&&!r)return t.statusCode=404,t.setHeader("x-nextjs-cache","REVALIDATED"),t.end("This page could not be found"),null;let i=await s(o);e.fetchMetrics=H.renderOpts.fetchMetrics;let l=H.renderOpts.pendingWaitUntil;l&&a.waitUntil&&(a.waitUntil(l),l=void 0);let u=H.renderOpts.collectedTags;if(!T)return await (0,p.sendResponse)(D,M,i,H.renderOpts.pendingWaitUntil),null;{let e=await i.blob(),t=(0,d.toNodeOutgoingHttpHeaders)(i.headers);u&&(t[h.NEXT_CACHE_TAGS_HEADER]=u),!t["content-type"]&&e.type&&(t["content-type"]=e.type);let r=void 0!==H.renderOpts.collectedRevalidate&&!(H.renderOpts.collectedRevalidate>=h.INFINITE_CACHE)&&H.renderOpts.collectedRevalidate,a=void 0===H.renderOpts.collectedExpire||H.renderOpts.collectedExpire>=h.INFINITE_CACHE?void 0:H.renderOpts.collectedExpire;return{value:{kind:x.CachedRouteKind.APP_ROUTE,status:i.status,body:Buffer.from(await e.arrayBuffer()),headers:t},cacheControl:{revalidate:r,expire:a}}}}catch(t){throw(null==r?void 0:r.isStale)&&await R.onRequestError(e,t,{routerKind:"App Router",routePath:v,routeType:"route",revalidateReason:(0,c.getRevalidateReason)({isRevalidate:O,isOnDemandRevalidate:k})},C),t}},m=await R.handleResponse({req:e,nextConfig:w,cacheKey:S,routeKind:r.RouteKind.APP_ROUTE,isFallback:!1,prerenderManifest:A,isRoutePPREnabled:!1,isOnDemandRevalidate:k,revalidateOnlyGenerated:j,responseGenerator:u,waitUntil:a.waitUntil});if(!T)return null;if((null==m||null==(i=m.value)?void 0:i.kind)!==x.CachedRouteKind.APP_ROUTE)throw Object.defineProperty(Error(`Invariant: app-route received invalid cache entry ${null==m||null==(l=m.value)?void 0:l.kind}`),"__NEXT_ERROR_CODE",{value:"E701",enumerable:!1,configurable:!0});(0,n.getRequestMeta)(e,"minimalMode")||t.setHeader("x-nextjs-cache",k?"REVALIDATED":m.isMiss?"MISS":m.isStale?"STALE":"HIT"),E&&t.setHeader("Cache-Control","private, no-cache, no-store, max-age=0, must-revalidate");let g=(0,d.fromNodeOutgoingHttpHeaders)(m.value.headers);return(0,n.getRequestMeta)(e,"minimalMode")&&T||g.delete(h.NEXT_CACHE_TAGS_HEADER),!m.cacheControl||t.getHeader("Cache-Control")||g.get("Cache-Control")||g.set("Cache-Control",(0,f.getCacheControlHeader)(m.cacheControl)),await (0,p.sendResponse)(D,M,new Response(m.value.body,{headers:g,status:m.value.status||200})),null};I?await i(I):await U.withPropagatedContext(e.headers,()=>U.trace(u.BaseServerSpan.handleRequest,{spanName:`${$} ${e.url}`,kind:o.SpanKind.SERVER,attributes:{"http.method":$,"http.target":e.url}},i))}catch(t){if(I||t instanceof m.NoFallbackError||await R.onRequestError(e,t,{routerKind:"App Router",routePath:N,routeType:"route",revalidateReason:(0,c.getRevalidateReason)({isRevalidate:O,isOnDemandRevalidate:k})}),T)throw t;return await (0,p.sendResponse)(D,M,new Response(null,{status:500})),null}}},236145,e=>{e.v(e=>Promise.resolve().then(()=>e(902808)))}];

//# sourceMappingURL=%5Broot-of-the-server%5D__d09ae5a0._.js.map