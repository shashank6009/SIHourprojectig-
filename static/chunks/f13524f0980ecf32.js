(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,773258,e=>{"use strict";async function s(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{method:t="GET",headers:a={},body:r}=s,l={method:t,headers:{"Content-Type":"application/json",...a}};r&&"GET"!==t&&(l.body=JSON.stringify(r));let n=await fetch(e,l);if(!n.ok)throw Error("HTTP ".concat(n.status,": ").concat(n.statusText));return n.json()}e.s(["http",()=>t]);let t={get:(e,t)=>s(e,{method:"GET",headers:t}),post:(e,t,a)=>s(e,{method:"POST",headers:a,body:t}),put:(e,t,a)=>s(e,{method:"PUT",headers:a,body:t}),delete:(e,t)=>s(e,{method:"DELETE",headers:t})}},5453,e=>{"use strict";e.s(["default",()=>r]);var s=e.i(843476),t=e.i(271645),a=e.i(773258);function r(e){let{versionId:r,isMentorMode:l=!1}=e,[n,i]=(0,t.useState)([]),[d,c]=(0,t.useState)(!0),[o,m]=(0,t.useState)(""),[x,u]=(0,t.useState)(l?"Mentor":""),[h,b]=(0,t.useState)(""),[g,p]=(0,t.useState)();(0,t.useEffect)(()=>{j()},[r]);let j=async()=>{try{let e=await a.http.get("/api/feedback/comment?resumeVersionId=".concat(r));i(e.data.comments||[])}catch(e){console.error("Failed to fetch comments:",e)}finally{c(!1)}},v=async()=>{if(o.trim()&&x.trim())try{await a.http.post("/api/feedback/comment",{resumeVersionId:r,blockId:h||void 0,lineRef:g,author:x,text:o}),m(""),b(""),p(void 0),j()}catch(e){console.error("Failed to add comment:",e)}},y=async(e,s)=>{try{await a.http.patch("/api/feedback/comment",{id:e,resolved:s}),j()}catch(e){console.error("Failed to update comment:",e)}},f=n.reduce((e,s)=>{let t=s.blockId||"general";return e[t]||(e[t]=[]),e[t].push(s),e},{});return d?(0,s.jsx)("div",{className:"w-80 bg-gray-50 p-4 border-l",children:(0,s.jsxs)("div",{className:"animate-pulse",children:[(0,s.jsx)("div",{className:"h-4 bg-gray-200 rounded mb-2"}),(0,s.jsx)("div",{className:"h-4 bg-gray-200 rounded mb-2"}),(0,s.jsx)("div",{className:"h-4 bg-gray-200 rounded"})]})}):(0,s.jsxs)("div",{className:"w-80 bg-gray-50 p-4 border-l max-h-screen overflow-y-auto",children:[(0,s.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"Comments & Feedback"}),(0,s.jsxs)("div",{className:"mb-6 p-4 bg-white rounded-lg border",children:[(0,s.jsx)("h4",{className:"font-medium mb-3",children:"Add Comment"}),(0,s.jsxs)("div",{className:"space-y-3",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Author"}),(0,s.jsx)("input",{type:"text",value:x,onChange:e=>u(e.target.value),placeholder:"Your name",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Block ID (optional)"}),(0,s.jsx)("input",{type:"text",value:h,onChange:e=>b(e.target.value),placeholder:"block-1",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Line Reference (optional)"}),(0,s.jsx)("input",{type:"number",value:g||"",onChange:e=>p(e.target.value?parseInt(e.target.value):void 0),placeholder:"1",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Comment"}),(0,s.jsx)("textarea",{value:o,onChange:e=>m(e.target.value),placeholder:"Add your feedback...",rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),(0,s.jsx)("button",{onClick:v,disabled:!o.trim()||!x.trim(),className:"w-full bg-blue-600 text-white py-2 px-4 rounded-md hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed",children:"Add Comment"})]})]}),(0,s.jsxs)("div",{className:"space-y-4",children:[Object.entries(f).map(e=>{let[t,a]=e;return(0,s.jsxs)("div",{className:"bg-white rounded-lg border p-3",children:[(0,s.jsx)("h4",{className:"font-medium text-sm text-gray-600 mb-2",children:"general"===t?"General Comments":"Block: ".concat(t)}),(0,s.jsx)("div",{className:"space-y-3",children:a.map(e=>(0,s.jsxs)("div",{className:"p-3 rounded-md border-l-4 ".concat(e.resolved?"bg-green-50 border-green-200":"bg-yellow-50 border-yellow-200"),children:[(0,s.jsxs)("div",{className:"flex justify-between items-start mb-2",children:[(0,s.jsxs)("div",{className:"text-sm",children:[(0,s.jsx)("span",{className:"font-medium text-gray-800",children:e.author}),(0,s.jsx)("span",{className:"text-gray-500 ml-2",children:new Date(e.createdAt).toLocaleDateString()}),e.lineRef&&(0,s.jsxs)("span",{className:"text-gray-500 ml-2",children:["Line ",e.lineRef]})]}),(0,s.jsx)("button",{onClick:()=>y(e.id,!e.resolved),className:"text-xs px-2 py-1 rounded ".concat(e.resolved?"bg-green-100 text-green-800":"bg-yellow-100 text-yellow-800"),children:e.resolved?"Resolved":"Mark Resolved"})]}),(0,s.jsx)("p",{className:"text-sm text-gray-700",children:e.text})]},e.id))})]},t)}),0===n.length&&(0,s.jsxs)("div",{className:"text-center text-gray-500 py-8",children:[(0,s.jsx)("p",{children:"No comments yet."}),(0,s.jsx)("p",{className:"text-sm",children:"Add the first comment above."})]})]})]})}},98078,e=>{"use strict";e.s(["default",()=>i]);var s=e.i(843476),t=e.i(271645),a=e.i(618566),r=e.i(773258),l=e.i(5453);function n(){var e,n,i,d;let[c,o]=(0,t.useState)(!0),[m,x]=(0,t.useState)(null),[u,h]=(0,t.useState)(null),[b,g]=(0,t.useState)(null),p=(0,a.useSearchParams)();(0,t.useEffect)(()=>{let e=p.get("token");if(!e){x("No review token provided"),o(!1);return}j(e)},[p]);let j=async e=>{try{let s=await r.http.get("/api/feedback/share?token=".concat(e));h(s.data.version),g(s.data.version.id)}catch(e){console.error("Token verification failed:",e),x(e.message||"Invalid or expired review link")}finally{o(!1)}};return c?(0,s.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),(0,s.jsx)("p",{className:"text-gray-600",children:"Verifying review link..."})]})}):m?(0,s.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,s.jsxs)("div",{className:"text-center max-w-md mx-auto p-6",children:[(0,s.jsx)("div",{className:"text-red-500 text-6xl mb-4",children:"⚠️"}),(0,s.jsx)("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Review Link Expired"}),(0,s.jsx)("p",{className:"text-gray-600 mb-4",children:m}),(0,s.jsx)("p",{className:"text-sm text-gray-500",children:"Please request a new review link from the resume owner."})]})}):u?(0,s.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,s.jsx)("div",{className:"bg-white shadow-sm border-b",children:(0,s.jsx)("div",{className:"max-w-7xl mx-auto px-4 py-4",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h1",{className:"text-xl font-semibold text-gray-900",children:"Mentor Review Mode"}),(0,s.jsxs)("p",{className:"text-sm text-gray-600",children:["Reviewing: ",u.label," • Created: ",new Date(u.created_at).toLocaleDateString()]})]}),(0,s.jsx)("div",{className:"text-sm text-gray-500",children:"Read-only access"})]})})}),(0,s.jsx)("div",{className:"max-w-7xl mx-auto px-4 py-8",children:(0,s.jsxs)("div",{className:"flex",children:[(0,s.jsxs)("div",{className:"flex-1 bg-white rounded-lg shadow-md p-6 mr-6",children:[(0,s.jsx)("h2",{className:"text-lg font-semibold mb-4",children:"Resume Content"}),(0,s.jsxs)("div",{className:"space-y-6",children:[null==(n=u.content)||null==(e=n.blocks)?void 0:e.map((e,t)=>{var a;return(0,s.jsxs)("div",{className:"border rounded-lg p-4",children:[(0,s.jsxs)("h3",{className:"font-semibold text-gray-800 mb-3 capitalize",children:[e.type," - ",e.title]}),e.description&&(0,s.jsx)("p",{className:"text-sm text-gray-600 mb-3 italic",children:e.description}),(0,s.jsx)("div",{className:"space-y-2",children:null==(a=e.details)?void 0:a.map((e,t)=>(0,s.jsxs)("div",{className:"flex items-start space-x-2",children:[(0,s.jsx)("span",{className:"text-gray-400 mt-1",children:"•"}),(0,s.jsx)("span",{className:"text-sm text-gray-700",children:e})]},t))}),(e.startDate||e.endDate)&&(0,s.jsxs)("div",{className:"mt-3 text-xs text-gray-500",children:[e.startDate&&(0,s.jsxs)("span",{children:["From: ",e.startDate]}),e.startDate&&e.endDate&&(0,s.jsx)("span",{children:" • "}),e.endDate&&(0,s.jsxs)("span",{children:["To: ",e.endDate]})]})]},t)}),(null==(i=u.content)?void 0:i.tailoredContent)&&(0,s.jsxs)("div",{className:"border-t pt-6",children:[(0,s.jsx)("h3",{className:"font-semibold text-gray-800 mb-3",children:"Tailored Content"}),(0,s.jsxs)("div",{className:"bg-blue-50 rounded-lg p-4",children:[(0,s.jsxs)("p",{className:"text-sm text-blue-800",children:[(0,s.jsx)("strong",{children:"ATS Score:"})," ",u.content.tailoredContent.atsScore,"%"]}),(null==(d=u.content.tailoredContent.gapSuggestions)?void 0:d.length)>0&&(0,s.jsxs)("div",{className:"mt-3",children:[(0,s.jsx)("p",{className:"text-sm font-medium text-blue-800 mb-2",children:"Gap Suggestions:"}),(0,s.jsx)("ul",{className:"text-sm text-blue-700 space-y-1",children:u.content.tailoredContent.gapSuggestions.map((e,t)=>(0,s.jsxs)("li",{children:["• ",e]},t))})]})]})]})]})]}),b&&(0,s.jsx)(l.default,{versionId:b,isMentorMode:!0})]})})]}):(0,s.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,s.jsx)("div",{className:"text-center",children:(0,s.jsx)("p",{className:"text-gray-600",children:"Loading resume..."})})})}function i(){return(0,s.jsx)(t.Suspense,{fallback:(0,s.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),(0,s.jsx)("p",{className:"text-gray-600",children:"Loading review page..."})]})}),children:(0,s.jsx)(n,{})})}}]);